# 과제 1
# 자바 스타일로 코딩(모든 것을 객체화하라)
# 실행 스크립트 빼고
# def main():
#   game = Game()
#   game.start()
#
# main()
# 클래스는 별도의 파일로 생성해서 호출하라
#
# 과제 2
# 전역변수 안 쓰기
#
# class를 이용해서 lol simulation을 만들어보자
#
# 1. requests를 사용해 champion정보를 가져온다.
#     1. http://ddragon.leagueoflegends.com/cdn/11.17.1/data/ko_KR/champion.json
# 2. red, blue팀에 랜덤으로 다섯개 챔피언을 생성한다(중복 허용 안됨)
# 3. 게임을 시작한다.
# 4. 챔피언은 상대팀의 다른 챔피언을 공격할 수 있고, hp가 0 이하로 떨어지면 사망처리되며, 사망처리되면 더이상 공격을 할 수 없다.
# 5. 게임이 시작되면 스피드가 높은 챔피언부터 순서대로 공격을 하며, 각 챔피언의 데미지는 챔피언의 타입에 따라 (attack * attackdamage) 혹은 (magic * attackdamage)가 될 수 있다(분류기준은 자유), 각 action을 print하자(ex: Azir가 Brand에게 123의 데미지를 주었다. Brand는 사망했다!)
# 6. 한 팀의 챔피언이 모두 사망할때까지 반복한다.
# 7. 게임이 종료되면 이긴 팀을 출력하자.
# 8. 완성된 코드는 github에 업로드할 것.

import requests
import json
import random

class Game:
    #requests, json으로 챔피언 정보 갖고 오기
    champion_info = json.loads(requests.get("http://ddragon.leagueoflegends.com/cdn/11.17.1/data/ko_KR/champion.json").text)["data"]
    #무작위로 챔피언 10개 생성 및 5개씩 redteam, blueteam 생성
    data = random.sample(list(champion_info), 10)

    def __init__(self):
        self.redteam = Team(self.data[0:5])
        self.blueteam = Team(self.data[5:10])

#게임 스따또!
    def gamestart(self):
        while self.redteam.all_death() or self.redteam.all_death():
            for champion in self._attack_order() :
                if champion in self.redteam:
                    foe = random.choice(self.blueteam)
                    foe.set_minus_hp(champion.attack(foe))
                else:
                    foe = random.choice(self.redteam)
                    foe.set_minus_hp(champion.attack(foe))

#공격 순서 정하기
    def _attack_order(self):
        all_champion = self.redteam + self.blueteam
        champion_and_speed = []
        attack_order = []
        for champion in all_chamion:
            champion_and_speed.append(champion, champion.getmovespeed())
        sorted(champion_and_speed, key=lambda x: x[2], reverse=True)
#       sorted(champion_and_speed, key=lambda x: -x[2])
        i = 0
        while i < len(champion_and_speed):
            attack_order.append(champion_and_speed[i][0])
            i += 1

        return attack_order

class Team:
    def __init__(self, champions):
        for champion in champions:
            self.team = []
            self.team.append(Champion(champion))

    def all_death(self):
        for champion in self.team:
            if champion.get_hp() > 0:
                return False
            else:
                return True

class Champion:
    champion_info = json.loads(requests.get("http://ddragon.leagueoflegends.com/cdn/11.17.1/data/ko_KR/champion.json").text)["data"]

    def __init__(self, champion):
        self.champion = champion
        self.movespeed = self.champion_info[champion]["stats"]["movespeed"]
        self.hp = self.champion_info[champion]["stats"]["hp"]
        self.attack = self.champion_info[champion]["info"]["attack"]
        self.magic = self.champion_info[champion]["info"]["magic"]
        if self.attack > self.magic:
            self.damage = self.champion_info[champion]["stats"]["attackdamage"] + self.attack
        else:
            self.damage = self.champion_info[champion]["stats"]["attackdamage"] + self.magic

    def attack(self, foe):
        print(f"{self.champion}이 {foe}를 {self.damage}만큼 공격하였습니다.")
        return self.damage

    def set_minus_hp(self, damage):
        self.hp -= damage

    def get_hp(self):
        return self.hp

    def get_movespeed(self):
        return self.speed

game = Game()
game.gamestart()




